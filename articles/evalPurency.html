<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>evalPurency • evalPurency</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="evalPurency">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">evalPurency</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3.7.9020</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/evalPurency.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/file-custom.html">Customize file specifications</a></li>
    <li><a class="dropdown-item" href="../articles/option-custom.html">Customize function options</a></li>
    <li><a class="dropdown-item" href="../articles/other-lab.html">Change settings to other labs' preferences</a></li>
    <li><a class="dropdown-item" href="../articles/output-custom.html">Customize the output</a></li>
    <li><a class="dropdown-item" href="../articles/troubleshooting.html">Troubleshooting</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Maki-science/evalPurency/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>evalPurency</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/Maki-science/evalPurency/blob/main/vignettes/evalPurency.Rmd" class="external-link"><code>vignettes/evalPurency.Rmd</code></a></small>
      <div class="d-none name"><code>evalPurency.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>After the corresponding paper is published, you should be able to
download this package from CRAN (watch the badge on the top of this
page). Just go to the upper tool bar of your RStudio and click
<em>tools</em> &gt; <em>Install Packages…</em> &gt; tipe in
<em>evalPurency</em> &gt; click <em>install</em>, or run:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"evalPurency"</span><span class="op">)</span></span></code></pre></div>
<p>You can also install the development version of evalPurency from <a href="https://github.com/" class="external-link">GitHub</a>. If not already installed, you
need to have Rtools installed on your system to be able to compile the
development version <em>(<a href="https://cran.r-project.org/bin/windows/Rtools/" class="external-link uri">https://cran.r-project.org/bin/windows/Rtools/</a>)</em>.
(devtools only has to be installed once)</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span> <span class="co"># just necessary if not already installed</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"Maki-science/evalPurency"</span><span class="op">)</span></span></code></pre></div>
<p>Once installed, you don’t need to repeat this step each time! If you
want to update to the newest version, just run the second line
again.</p>
</div>
<div class="section level2">
<h2 id="naming-workflow">Naming &amp; workflow<a class="anchor" aria-label="anchor" href="#naming-workflow"></a>
</h2>
<p>The (pre-)Purency workflow usually produces several filters (or
measurements) for each sample. These are scanned via µ-FTIR and the
resulting data is analysed with the Microplastic Finder of Purency. This
software produces *.csv files for each sample containg all particles and
their annotation, which is usually cured and refined by a human. Then,
the files for each sample have to be corrected by blank results and
summarized. And here is were we jump in:</p>
<p>We highly recommend to adopt a common file-naming procedure. The
function uses everything of the .csv file names before the first ’_’
(underline) as sample name. The rest is considered as filter/measurement
(e.g., SAMPLENAME_Filter1of3). This also allows for one blank for
multiple filters/samples from one location (i.e., replicates), by naming
the samples accordingly.</p>
<p>Here are some examples how to apply the naming for different blank
application:</p>
<p>For each sample one or more own blank filters. You can still have
several filters for each sample and/or blank, which are summed together
before processing:</p>
<ul>
<li>Samples: SAMPLENAME1_Filter1, SAMPLENAME2_Filter1</li>
<li>Blanks: SAMPLENAME1Blank_Filter1, SAMPLENAME2Blank_filter1</li>
</ul>
<p>Samples should use the same blank(s):</p>
<ul>
<li>Samples: SAMPLENAME1_Filter1, SAMPLENAME2_Filter1</li>
<li>Blank: SAMPLENAMEBlank_Filter1 (notice the missing number)</li>
</ul>
<p>You have several blanks, but they should be averaged as combined
blank for your samples (still, each blank can constitute several filters
that are summed before averaging over the blanks):</p>
<ul>
<li>Samples: SAMPLENAME1_Filter1, SAMPLENAME2_Filter1</li>
<li>Blanks: SAMPLENAME1Blank1_Filter1, SAMPLENAME1Blank2_filter1,
SAMPLENAME2Blank1_Filter1, SAMPLENAME2Blank2_filter1 (note the number
(or any other sign) behind ‘Blank’ but before ’_’)</li>
</ul>
<p>You want to use one (or several averaged) blanks for all samples:</p>
<ul>
<li>Samples: PREFIXSAMPLENAME1_Filter1, PREFIXSAMPLENAME2_Filter1 (set a
prefix)</li>
<li>Blanks: PREFIXBlank_Filter1, PREFIXBLank_filter1 (use the same
prefix but directly state ‘Blank_’)</li>
</ul>
<p>You can also use a mix of all those versions, if necessary, though,
we think this might be a bad sampling design.</p>
<p>If you don’t have any blanks to process, you can skip the blank
processing with setting <code>noBlank = TRUE</code>.</p>
<p><em>Warning: The names should always be uniquely identifyable. For
instance, having a blank called ‘TESTBlank_filterx’, and samples called
‘TEST_filtery’ and ‘somethingelseTEST_filterz’ would have a match for
‘TEST’ in both samples, even though they are thought be separately
blank-corrected. Therefore, the ‘test’ is not clearly identifyable and
the second sample should not include test, or the blank must be renamed
more precisely.</em></p>
<p><em>WARNING: The naming of the files is an important prerequisite for
a proper processing. Thus you need to cautiously set your file
names!</em></p>
<p>Put all files you want to process including their blank files into
one folder. We recommend to put all files of a certain project/study or
similar into one folder and process them at once.</p>
</div>
<div class="section level2">
<h2 id="processing-possibilities">Processing possibilities<a class="anchor" aria-label="anchor" href="#processing-possibilities"></a>
</h2>
<p>To use the package function, just load the package as usual:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/Maki-science/evalPurency" class="external-link">evalPurency</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="processing-a-summary-with-blank-correction">Processing a summary with blank correction<a class="anchor" aria-label="anchor" href="#processing-a-summary-with-blank-correction"></a>
</h3>
<p>Now simply run the follwing line, but change the path accordingly to
the location where you stored your files to be processed. Make sure to
use (or change) <code>/</code> and not <code>\</code>, since only
windows uses backslashes.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/evalPurency.html">evalPurency</a></span><span class="op">(</span>path<span class="op">=</span><span class="st">"C:/users/MYNAME/Desktop/MYFILESTOBEPROCESSED/"</span><span class="op">)</span> <span class="co"># or similar</span></span></code></pre></div>
<p><em>Note: The <code>/</code> in the end is required!</em> Copy and
paste this line into the console and press ‘enter’.</p>
<p><em>WARNING: This runs the function with its default configuration.
You might need to adopt some further parameters. See below for
details.</em></p>
<p><em>WARNING: Make sure that your .csv file has the correct column
separator (; in default) and decimal sign (, in default). Otherwise read
further below how to change it in the function, or make sure to save the
.csv file properly.</em></p>
<p>The function will warn you if there are missing values at some files.
The respective files and columns are reported. Once it finished the
processing it will message that it is done.</p>
<div class="section level4">
<h4 id="output-of-evalpurency">Output of evalPurency()<a class="anchor" aria-label="anchor" href="#output-of-evalpurency"></a>
</h4>
<p>It will usually need just very few seconds to process e.g. 100 files,
of course depending on the particle number. An excel file for each
sample is created in the selected folder where the sample results are
summarized. For all files there is one additional file with the
processing data. There you can find data sets of each processing step on
separate sheets (also raw data), so you can trace back the calculation
and/or load parts of the data into R if required without running the
whole function again.</p>
<p>For compatibility the Excel files are of an old version. Therefore,
there might occur a message about potential broken file that you have to
confirm. However, the warning can be ignored. <em>Note that the excel
file will be coded with ‘.’ as decimal sign!</em></p>
</div>
</div>
<div class="section level3">
<h3 id="perform-particle-wise-processing">Perform particle wise processing<a class="anchor" aria-label="anchor" href="#perform-particle-wise-processing"></a>
</h3>
<p>In some cases it might be necessary to perform the processing and
blank correction with a particle list, retaining the information about
each single particle (compared to the size-class summary above). The aim
here is, to keep each particle as such in the list, but still allow a
correction for blank particles. Therefore, we created the second
function <code><a href="../reference/evalPurency.particles.html">evalPurency.particles()</a></code>. It mainly uses the area
of each particle as size reference. In case of several blanks per
sample, most similar particles across blank replicates will be averaged,
while the blank correction is performed by searching the most similar
particles within a certain range and then substract that particle from
the list. This preserves each particle and its traits, e.g., for
simulation purposes, while still allowing a rather conservative blank
correction. Details are described below.</p>
<div class="section level4">
<h4 id="how-to-use-evalpurency-particles">How to use evalPurency.particles()<a class="anchor" aria-label="anchor" href="#how-to-use-evalpurency-particles"></a>
</h4>
<p>As before, simply load the library command after the package have
been installed:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/Maki-science/evalPurency" class="external-link">evalPurency</a></span><span class="op">)</span></span></code></pre></div>
<p>Make sure that the files are named according to your requirements for
blank processing. The same rules apply as for <code><a href="../reference/evalPurency.html">evalPurency()</a></code>
(see above).</p>
<p>If no further requirements have to be fulfilled, the function can be
run with just the path of the files to be processed as with the other
function:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/evalPurency.particles.html">evalPurency.particles</a></span><span class="op">(</span>path<span class="op">=</span><span class="st">"C:/users/MYNAME/Desktop/MYFILESTOBEPROCESSED/"</span><span class="op">)</span> <span class="co"># or similar</span></span></code></pre></div>
<p>For further functionality, most of the parameters below can also be
applied for this function. However, in case of <code>sizeclasses</code>,
the function uses the squared value of each size class for
categorization. This is because it seemed more intuitive to use simple
edge lengths for the categorization, since a size class for an area of
22,500 (edge length of 150 µm) is rather abstract.</p>
<p>Further, the area of fibres is recalculated according to the manually
measured actual length of fibres. Purencys’ Microplastic Finder does not
calculate the length of fibres correctly, since it just takes the
distance from edge to edge. Changing angles are not considered, why the
proper length is measured manually. As probably most suitable
approximation of the real area of a fibre, this function multiplies the
width by the actual (manually measured) length. This recalculated area
can be found in the output file.</p>
</div>
<div class="section level4">
<h4 id="output-of-evalpurency-particles">Output of evalPurency.particles()<a class="anchor" aria-label="anchor" href="#output-of-evalpurency-particles"></a>
</h4>
<p>This function creates one .xls file, <em>processing_data.csv</em>.
Here, you can find several sheets with the processed sample particles,
processed blanks, removed sample and blank particles, and the raw sample
and blank data. These data reflect each step of the processing. The
sheets on removed particles include a column where it is stated, how the
particle was processed (each particle gets an index to track each action
of the function). <em>Note that the excel file will be coded with ‘.’ as
decimal sign, as before!</em></p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="customization">Customization<a class="anchor" aria-label="anchor" href="#customization"></a>
</h2>
<p>There are a lot of possibilities to customize the function, the
processing and the output. Check the options below or in the upper
toolbar for further consideration. <em>WARNING: some options are
obligatory to be checked! Otherwise, the results might be not
relyable!</em></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Marvin Kiene, Eva Cseperke Vizsolyi, Martin Löder, Christian Laforsch.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
